<?xml version="1.0" encoding="UTF-8"?>

<PlanDefinition xmlns="http://hl7.org/fhir">
  <id value="ANCDT07"/>
  <text>
    <status value="extensions"/><div xmlns="http://www.w3.org/1999/xhtml">
  <table class="narrative-table">
    <tbody>
<tr>


<th colspan="2" scope="row" class="row-header">Metadata</th>


</tr>

<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">ANC.DT.07 Ultrasound recommendation</td>
</tr>



<tr>


<th scope="row" class="row-header">Version</th>


<td class="content-container">0.3.0</td>
</tr>







  
<tr>


<th scope="row" class="row-header">Identifier</th>


<td class="content-container">ANC.DT.07</td>
</tr>









<tr>


<th scope="row" class="row-header">Use Context</th>


<td class="content-container"><span title="{http://terminology.hl7.org/CodeSystem/usage-context-type task}">Workflow Task</span> = <span title="Codes:{http://smart.who.int/anc/CodeSystem/activity-codes During}">woman’s history/profile or lab and imaging tests</span></td>
</tr>


<tr>


<th scope="row" class="row-header">Jurisdiction</th>


<td class="content-container"><span title="Codes:{http://unstats.un.org/unsd/methods/m49/m49.htm 001}">Global (Whole world)</span></td>
</tr>








<tr>


<th scope="row" class="row-header">Steward (Publisher)</th>


<td class="content-container">World Health Organization (WHO)</td>
</tr>









<tr>


<th scope="row" class="row-header">Description</th>


<td class="content-container"><div><p>An ultrasound is recommended for all pregnant women before 24 weeks of gestation (early ultrasound). If there's no ultrasound available at that health-carte facility, the woman should be referred to another facility in which she can receive an ultrasound.</p>
</div></td>
</tr>






<tr>


<th scope="row" class="row-header">Type</th>


<td class="content-container"><span title="Codes:{http://terminology.hl7.org/CodeSystem/plan-definition-type eca-rule}">ECA Rule</span></td>
</tr>




<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Action</th>


</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">ANC.DT.07 Ultrasound recommendation</td>
</tr>










<tr>


<th scope="row" class="row-header">Trigger Type</th>


<td class="content-container">Named Event</td>
</tr>


<tr>


<th scope="row" class="row-header">Trigger Name</th>


<td class="content-container">During woman’s history/profile or lab and imaging tests</td>
</tr>

















  
    
    
      
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action (Parent Action Title: ANC.DT.07 Ultrasound recommendation)</th>


</tr>

<tr>


<th scope="row" class="row-header">Id</th>


<td class="content-container">1</td>
</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Conduct ultrasound at the health-care facility or the referral facility</td>
</tr>


<tr>


<th scope="row" class="row-header">Description</th>


<td class="content-container">Conduct ultrasound at the health-care facility or the referral facility</td>
</tr>


<tr>


<th scope="row" class="row-header">Human-interpretable Description</th>


<td class="content-container">An ultrasound is recommended for all women before 24 weeks gestation</td>
</tr>








<tr>
  <th scope="row" class="row-header">Condition</th>
  <td class="content-container">
  <em>Kind</em>: Applicability
  
    <br/>
    
      
      <em>Logic Definition</em>: <a href="#ancdt07-should-conduct-ultrasound-at-the-health-care-facility-or-the-referral-facility">Should Conduct ultrasound at the health-care facility or the referral facility</a> 
    
   
  </td>
</tr>















    
  
    
    
      
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action (Parent Action Title: ANC.DT.07 Ultrasound recommendation)</th>


</tr>

<tr>


<th scope="row" class="row-header">Id</th>


<td class="content-container">2</td>
</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Conduct ultrasound at the health-care facility or the referral facility optional if deemed necessary by the health worker</td>
</tr>


<tr>


<th scope="row" class="row-header">Description</th>


<td class="content-container">Conduct ultrasound at the health-care facility or the referral facility optional if deemed necessary by the health worker</td>
</tr>


<tr>


<th scope="row" class="row-header">Human-interpretable Description</th>


<td class="content-container">An ultrasound is recommended for all women even after 24 weeks gestation if deemed necessary (e.g. to identify the number of fetuses, fetal presentation or placenta location)</td>
</tr>








<tr>
  <th scope="row" class="row-header">Condition</th>
  <td class="content-container">
  <em>Kind</em>: Applicability
  
    <br/>
    
      
      <em>Logic Definition</em>: <a href="#ancdt07-should-conduct-ultrasound-at-the-health-care-facility-or-the-referral-facility-optional-if-deemed-necessary-by-the-health-worker">Should Conduct ultrasound at the health-care facility or the referral facility optional if deemed necessary by the health worker</a> 
    
   
  </td>
</tr>















    
  
    
    
      
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action (Parent Action Title: ANC.DT.07 Ultrasound recommendation)</th>


</tr>

<tr>


<th scope="row" class="row-header">Id</th>


<td class="content-container">3</td>
</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Conduct ultrasound scan</td>
</tr>


<tr>


<th scope="row" class="row-header">Description</th>


<td class="content-container">Conduct ultrasound scan</td>
</tr>


<tr>


<th scope="row" class="row-header">Human-interpretable Description</th>


<td class="content-container">An ultrasound is recommended for all women before 24 weeks gestation or even after if deemed necessary (e.g. to identify the number of fetuses, fetal presentation or placenta location). 
An early ultrasound is key to estimate gestational age, improve detection of fetal anomalies and multiple fetuses, reduce induction of labour for post-term pregnancy, and improve a woman’s pregnancy experience.</td>
</tr>








<tr>
  <th scope="row" class="row-header">Condition</th>
  <td class="content-container">
  <em>Kind</em>: Applicability
  
    <br/>
    
      
      <em>Logic Definition</em>: <a href="#ancdt07-should-conduct-ultrasound-scan">Should Conduct ultrasound scan</a> 
    
   
  </td>
</tr>















    
  
    
    
      
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action (Parent Action Title: ANC.DT.07 Ultrasound recommendation)</th>


</tr>

<tr>


<th scope="row" class="row-header">Id</th>


<td class="content-container">4</td>
</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Refer to a facility with ultrasound equipment</td>
</tr>


<tr>


<th scope="row" class="row-header">Description</th>


<td class="content-container">Refer to a facility with ultrasound equipment</td>
</tr>


<tr>


<th scope="row" class="row-header">Human-interpretable Description</th>


<td class="content-container">If an ultrasound cannot be conducted at the health-care facility, the woman should be referred to another health-care facility in which she can receive an ultrasound. 
An ultrasound is recommended for all women before 24 weeks gestation or even after if deemed necessary (e.g. to identify the number of fetuses, fetal presentation or placenta location). 
An early U/S is key to estimate gestational age, improve detection of fetal anomalies and multiple fetuses, reduce induction of labour for post-term pregnancy, and improve a woman’s pregnancy experience.</td>
</tr>








<tr>
  <th scope="row" class="row-header">Condition</th>
  <td class="content-container">
  <em>Kind</em>: Applicability
  
    <br/>
    
      
      <em>Logic Definition</em>: <a href="#ancdt07-should-refer-to-a-facility-with-ultrasound-equipment">Should Refer to a facility with ultrasound equipment</a> 
    
   
  </td>
</tr>















    
  
    
    
      
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action (Parent Action Title: ANC.DT.07 Ultrasound recommendation)</th>


</tr>

<tr>


<th scope="row" class="row-header">Id</th>


<td class="content-container">5</td>
</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Ultrasound scan is optional</td>
</tr>


<tr>


<th scope="row" class="row-header">Description</th>


<td class="content-container">Ultrasound scan is optional</td>
</tr>


<tr>


<th scope="row" class="row-header">Human-interpretable Description</th>


<td class="content-container">An ultrasound is recommended for all women before 24 weeks gestation or even after if deemed necessary (e.g. to identify the number of fetuses, fetal presentation or placenta location)</td>
</tr>








<tr>
  <th scope="row" class="row-header">Condition</th>
  <td class="content-container">
  <em>Kind</em>: Applicability
  
    <br/>
    
      
      <em>Logic Definition</em>: <a href="#ancdt07-should-ultrasound-scan-is-optional">Should Ultrasound scan is optional</a> 
    
   
  </td>
</tr>















  
    
      
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action (Parent Action ID: 5)</th>


</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Ultrasound scan is optional</td>
</tr>
























    
    
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action</th>


</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Ultrasound scan is optional</td>
</tr>
























    
  
    
      
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action (Parent Action ID: 5)</th>


</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Conduct ultrasound if deemed necessary by the health worker</td>
</tr>
























    
    
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action</th>


</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Conduct ultrasound if deemed necessary by the health worker</td>
</tr>
























    
  

    
  
    
    
      
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action (Parent Action Title: ANC.DT.07 Ultrasound recommendation)</th>


</tr>

<tr>


<th scope="row" class="row-header">Id</th>


<td class="content-container">6</td>
</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Ultrasound scan is optional</td>
</tr>


<tr>


<th scope="row" class="row-header">Description</th>


<td class="content-container">Ultrasound scan is optional 2</td>
</tr>


<tr>


<th scope="row" class="row-header">Human-interpretable Description</th>


<td class="content-container">An ultrasound is recommended for all women before 24 weeks gestation or even after if deemed necessary (e.g. to identify the number of fetuses, fetal presentation or placenta location)</td>
</tr>








<tr>
  <th scope="row" class="row-header">Condition</th>
  <td class="content-container">
  <em>Kind</em>: Applicability
  
    <br/>
    
      
      <em>Logic Definition</em>: <a href="#ancdt07-should-ultrasound-scan-is-optional-2">Should Ultrasound scan is optional 2</a> 
    
   
  </td>
</tr>















  
    
      
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action (Parent Action ID: 6)</th>


</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Ultrasound scan is optional</td>
</tr>
























    
    
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action</th>


</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Ultrasound scan is optional</td>
</tr>
























    
  
    
      
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action (Parent Action ID: 6)</th>


</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Refer for ultrasound if deemed necessary by the health worker</td>
</tr>
























    
    
      
<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Sub-Action</th>


</tr>




<tr>


<th scope="row" class="row-header">Title</th>


<td class="content-container">Refer for ultrasound if deemed necessary by the health worker</td>
</tr>
























    
  

    
  



<tr>


<th colspan="2" scope="row" class="row-header">PlanDefinition Logic</th>


</tr>

<tr>


<th scope="row" class="row-header">Primary Library</th>


<td class="content-container"><a href="Library-ANCDT07.html">ANC.DT.07 Ultrasound recommendation</a></td>
</tr>




  
  

<tr>
  
  
  
  
  

<th scope="row" class="row-header">Dependency</th>


  
  <td class="content-container">
    
    <em>Description</em>: Library FHIRHelpers
    
    <br/>
    
    
    
    
    
    
    <em>Resource</em>: <code>http://smart.who.int/anc/Library/FHIRHelpers|4.0.1</code>
    <br/>
    <em>Canonical URL</em>: <tt>http://smart.who.int/anc/Library/FHIRHelpers|4.0.1</tt>
    
    
    
  </td>
</tr>

<tr>
  
  
  
  
  

<th scope="row" class="row-header">Dependency</th>


  
  <td class="content-container">
    
    <em>Description</em>: Library ContactData
    
    <br/>
    
    
    
    
    
    
    <em>Resource</em>: <a href="Library-ANCContactDataElements.html">ANC Contact Data Elements</a>
    <br/>
    <em>Canonical URL</em>: <tt>http://smart.who.int/anc/Library/ANCContactDataElements</tt>
    
    
    
  </td>
</tr>

<tr>
  
  
  
  
  

<th scope="row" class="row-header">Dependency</th>


  
  <td class="content-container">
    
    <em>Description</em>: Library WC
    
    <br/>
    
    
    
    
    
    
    <em>Resource</em>: <a href="Library-WHOCommon.html">WHO Common</a>
    <br/>
    <em>Canonical URL</em>: <tt>http://smart.who.int/anc/Library/WHOCommon</tt>
    
    
    
  </td>
</tr>

<tr>
  
  
  
  
  

<th scope="row" class="row-header">Dependency</th>


  
  <td class="content-container">
    
    <em>Description</em>: Library Cx
    
    <br/>
    
    
    
    
    
    
    <em>Resource</em>: <a href="Library-ANCConcepts.html">ANC Concepts</a>
    <br/>
    <em>Canonical URL</em>: <tt>http://smart.who.int/anc/Library/ANCConcepts</tt>
    
    
    
  </td>
</tr>

<tr>
  
  
  
  
  

<th scope="row" class="row-header">Dependency</th>


  
  <td class="content-container">
    
    <em>Description</em>: Library Config
    
    <br/>
    
    
    
    
    
    
    <em>Resource</em>: <a href="Library-ANCConfig.html">ANC Configuration</a>
    <br/>
    <em>Canonical URL</em>: <tt>http://smart.who.int/anc/Library/ANCConfig</tt>
    
    
    
  </td>
</tr>

<tr>
  
  
  
  
  

<th scope="row" class="row-header">Dependency</th>


  
  <td class="content-container">
    
    <em>Description</em>: Value set Ultrasound done
    
    <br/>
    
    
    
    
    
    
    <em>Resource</em>: <a href="ValueSet-anc-b6-de15.html">Ultrasound done</a>
    <br/>
    <em>Canonical URL</em>: <tt>http://smart.who.int/anc/ValueSet/anc-b6-de15</tt>
    
    
    
  </td>
</tr>

<tr>
  
  
  
  
  

<th scope="row" class="row-header">Dependency</th>


  
  <td class="content-container">
    
    <em>Description</em>: Value set Gestational age
    
    <br/>
    
    
    
    
    
    
    <em>Resource</em>: <a href="ValueSet-anc-b6-de17.html">Gestational age</a>
    <br/>
    <em>Canonical URL</em>: <tt>http://smart.who.int/anc/ValueSet/anc-b6-de17</tt>
    
    
    
  </td>
</tr>


  
  
  
<tr>
  

<th scope="row" class="row-header">Parameter</th>


  <td class="content-container">
    
    <em>Name</em>: encounter
    
    
    <br/>
    
    
    <em>Use</em>: In
    
    
    <br/>
    
    
    <em>Min Cardinality</em>: 0
    
    
    <br/>
    
    
    <em>Max Cardinality</em>: 1
    
    
    <br/>
    
    
    <em>Type</em>: string
    
  </td>
</tr>

<tr>
  

<th scope="row" class="row-header">Parameter</th>


  <td class="content-container">
    
    <em>Name</em>: Should Ultrasound scan is optional
    
    
    <br/>
    
    
    <em>Use</em>: Out
    
    
    <br/>
    
    
    <em>Min Cardinality</em>: 0
    
    
    <br/>
    
    
    <em>Max Cardinality</em>: 1
    
    
    <br/>
    
    
    <em>Type</em>: boolean
    
  </td>
</tr>

<tr>
  

<th scope="row" class="row-header">Parameter</th>


  <td class="content-container">
    
    <em>Name</em>: Should Ultrasound scan is optional 2
    
    
    <br/>
    
    
    <em>Use</em>: Out
    
    
    <br/>
    
    
    <em>Min Cardinality</em>: 0
    
    
    <br/>
    
    
    <em>Max Cardinality</em>: 1
    
    
    <br/>
    
    
    <em>Type</em>: boolean
    
  </td>
</tr>

<tr>
  

<th scope="row" class="row-header">Parameter</th>


  <td class="content-container">
    
    <em>Name</em>: Should Conduct ultrasound at the health-care facility or the referral facility
    
    
    <br/>
    
    
    <em>Use</em>: Out
    
    
    <br/>
    
    
    <em>Min Cardinality</em>: 0
    
    
    <br/>
    
    
    <em>Max Cardinality</em>: 1
    
    
    <br/>
    
    
    <em>Type</em>: boolean
    
  </td>
</tr>

<tr>
  

<th scope="row" class="row-header">Parameter</th>


  <td class="content-container">
    
    <em>Name</em>: Should Conduct ultrasound at the health-care facility or the referral facility optional if deemed necessary by the health worker
    
    
    <br/>
    
    
    <em>Use</em>: Out
    
    
    <br/>
    
    
    <em>Min Cardinality</em>: 0
    
    
    <br/>
    
    
    <em>Max Cardinality</em>: 1
    
    
    <br/>
    
    
    <em>Type</em>: boolean
    
  </td>
</tr>

<tr>
  

<th scope="row" class="row-header">Parameter</th>


  <td class="content-container">
    
    <em>Name</em>: Should Conduct ultrasound scan
    
    
    <br/>
    
    
    <em>Use</em>: Out
    
    
    <br/>
    
    
    <em>Min Cardinality</em>: 0
    
    
    <br/>
    
    
    <em>Max Cardinality</em>: 1
    
    
    <br/>
    
    
    <em>Type</em>: boolean
    
  </td>
</tr>

<tr>
  

<th scope="row" class="row-header">Parameter</th>


  <td class="content-container">
    
    <em>Name</em>: Should Refer to a facility with ultrasound equipment
    
    
    <br/>
    
    
    <em>Use</em>: Out
    
    
    <br/>
    
    
    <em>Min Cardinality</em>: 0
    
    
    <br/>
    
    
    <em>Max Cardinality</em>: 1
    
    
    <br/>
    
    
    <em>Type</em>: boolean
    
  </td>
</tr>

  
  
  <tr>
    <th colspan="2" scope="row" class="section-header"><a name="effective-data-requirements"> </a>PlanDefinition Logic Data Requirements</th>
  </tr>
  
  
<tr>
  <th scope="row" class="row-header">Data Requirement</th>
  <td class="content-container">
    <em>Type</em>: Observation
    <br/>
  
    <em>Profile(s)</em>: 
  
    <a href="http://hl7.org/fhir/R4/observation.html">Observation</a>
    <br/>        
  
   
   
    <em>Must Support Elements</em>: code, status, encounter, encounter.reference
    <br/>
   
  
    <em>Code Filter(s)</em>: 
    <br/>
  
  
    <span class="tab-one"><em>Path</em>: code</span>
    <br/>
  
  
  
    <span class="tab-one"><em>ValueSet</em>:</span> <a href="ValueSet-anc-b6-de15.html">Ultrasound done</a>
    <br/> 
  
  
  
   
  </td>
</tr>

<tr>
  <th scope="row" class="row-header">Data Requirement</th>
  <td class="content-container">
    <em>Type</em>: Observation
    <br/>
  
    <em>Profile(s)</em>: 
  
    <a href="http://hl7.org/fhir/R4/observation.html">Observation</a>
    <br/>        
  
   
   
    <em>Must Support Elements</em>: code, status, encounter, encounter.reference
    <br/>
   
  
    <em>Code Filter(s)</em>: 
    <br/>
  
  
    <span class="tab-one"><em>Path</em>: code</span>
    <br/>
  
  
  
    <span class="tab-one"><em>ValueSet</em>:</span> <a href="ValueSet-anc-b6-de17.html">Gestational age</a>
    <br/> 
  
  
  
   
  </td>
</tr>

  
  <tr>
  <th scope="row" rowspan="2" class="row-header">
    
    Logic Definition
  </th>

</tr>
<tr>

</tr>

  

<tr>
  <th colspan="2" scope="row" class="row-header">Generated using version 0.4.9-cibuild of the sample-content-ig Liquid templates</th>
</tr>

    </tbody>
  </table>
</div>
  </text>
  <contained>
    <Library>
      <id value="effective-data-requirements"/>
      <name value="EffectiveDataRequirements"/>
      <status value="active"/>
      <type>
        <coding>
          <system value="http://terminology.hl7.org/CodeSystem/library-type"/>
          <code value="module-definition"/>
        </coding>
      </type>
      <relatedArtifact>
        <type value="depends-on"/>
        <display value="Library FHIRHelpers"/>
        <resource value="http://smart.who.int/anc/Library/FHIRHelpers|4.0.1"/>
      </relatedArtifact>
      <relatedArtifact>
        <type value="depends-on"/>
        <display value="Library ContactData"/>
        <resource value="http://smart.who.int/anc/Library/ANCContactDataElements"/>
      </relatedArtifact>
      <relatedArtifact>
        <type value="depends-on"/>
        <display value="Library WC"/>
        <resource value="http://smart.who.int/anc/Library/WHOCommon"/>
      </relatedArtifact>
      <relatedArtifact>
        <type value="depends-on"/>
        <display value="Library Cx"/>
        <resource value="http://smart.who.int/anc/Library/ANCConcepts"/>
      </relatedArtifact>
      <relatedArtifact>
        <type value="depends-on"/>
        <display value="Library Config"/>
        <resource value="http://smart.who.int/anc/Library/ANCConfig"/>
      </relatedArtifact>
      <relatedArtifact>
        <type value="depends-on"/>
        <display value="Value set Ultrasound done"/>
        <resource value="http://smart.who.int/anc/ValueSet/anc-b6-de15"/>
      </relatedArtifact>
      <relatedArtifact>
        <type value="depends-on"/>
        <display value="Value set Gestational age"/>
        <resource value="http://smart.who.int/anc/ValueSet/anc-b6-de17"/>
      </relatedArtifact>
      <parameter>
        <name value="encounter"/>
        <use value="in"/>
        <min value="0"/>
        <max value="1"/>
        <type value="string"/>
      </parameter>
      <parameter>
        <name value="Should Ultrasound scan is optional"/>
        <use value="out"/>
        <min value="0"/>
        <max value="1"/>
        <type value="boolean"/>
      </parameter>
      <parameter>
        <name value="Should Ultrasound scan is optional 2"/>
        <use value="out"/>
        <min value="0"/>
        <max value="1"/>
        <type value="boolean"/>
      </parameter>
      <parameter>
        <name value="Should Conduct ultrasound at the health-care facility or the referral facility"/>
        <use value="out"/>
        <min value="0"/>
        <max value="1"/>
        <type value="boolean"/>
      </parameter>
      <parameter>
        <name value="Should Conduct ultrasound at the health-care facility or the referral facility optional if deemed necessary by the health worker"/>
        <use value="out"/>
        <min value="0"/>
        <max value="1"/>
        <type value="boolean"/>
      </parameter>
      <parameter>
        <name value="Should Conduct ultrasound scan"/>
        <use value="out"/>
        <min value="0"/>
        <max value="1"/>
        <type value="boolean"/>
      </parameter>
      <parameter>
        <name value="Should Refer to a facility with ultrasound equipment"/>
        <use value="out"/>
        <min value="0"/>
        <max value="1"/>
        <type value="boolean"/>
      </parameter>
      <dataRequirement>
        <type value="Observation"/>
        <profile value="http://hl7.org/fhir/StructureDefinition/Observation"/>
        <mustSupport value="code"/>
        <mustSupport value="status"/>
        <mustSupport value="encounter"/>
        <mustSupport value="encounter.reference"/>
        <codeFilter>
          <path value="code"/>
          <valueSet value="http://smart.who.int/anc/ValueSet/anc-b6-de15"/>
        </codeFilter>
      </dataRequirement>
      <dataRequirement>
        <type value="Observation"/>
        <profile value="http://hl7.org/fhir/StructureDefinition/Observation"/>
        <mustSupport value="code"/>
        <mustSupport value="status"/>
        <mustSupport value="encounter"/>
        <mustSupport value="encounter.reference"/>
        <codeFilter>
          <path value="code"/>
          <valueSet value="http://smart.who.int/anc/ValueSet/anc-b6-de17"/>
        </codeFilter>
      </dataRequirement>
    </Library>
  </contained>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="ANCContactDataElements"/>
    </extension>
    <extension url="name">
      <valueString value="Ultrasound done"/>
    </extension>
    <extension url="statement">
      <valueString value="/*&#xA;  @dataElement: ANC.B6.DE15 Ultrasound done&#xA;  @activity: ANC.B6 Profile&#xA;  @description: Whether or not the woman has had an ultrasound scan done at any point in this pregnancy&#xA;*/&#xA;define &quot;Ultrasound done&quot;:&#xA;  WC.MostRecent(&#xA;  [Observation: Cx.&quot;Ultrasound done&quot;] O&#xA;    where O.status in { 'final', 'amended', 'corrected' }&#xA;      and Coalesce(WC.ModifierExtension(O, 'who-notDone').value, false) is false&#xA;      and Last(Split(O.encounter.reference, '/')) = Last(Split(encounter, '/'))&#xA;  ).value as FHIR.boolean"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="0"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="ANCConfig"/>
    </extension>
    <extension url="name">
      <valueString value="Ultrasound available at the health-care facility"/>
    </extension>
    <extension url="statement">
      <valueString value="/*&#xA;  Description: Is an ultrasound machine available and functional at your&#xA;    facility and a trained health worker available to use it?&#xA;*/&#xA;define &quot;Ultrasound available at the health-care facility&quot;:&#xA;  true"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="1"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="ANCContactDataElements"/>
    </extension>
    <extension url="name">
      <valueString value="Gestational age"/>
    </extension>
    <extension url="statement">
      <valueString value="/*&#xA;  @dataElement: ANC.B6.DE17 Gestational age&#xA;  @activity: ANC.B6 Profile&#xA;  @description: Gestational age in weeks and/or days depending on the source of gestational age&#xA;*/&#xA;define &quot;Gestational age&quot;:&#xA;  WC.MostRecent(&#xA;  [Observation: Cx.&quot;Gestational age&quot;] O&#xA;    where O.status in { 'final', 'amended', 'corrected' }&#xA;      and Coalesce(WC.ModifierExtension(O, 'who-notDone').value, false) is false&#xA;      and Last(Split(O.encounter.reference, '/')) = Last(Split(encounter, '/'))&#xA;  ).value as FHIR.Quantity"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="2"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="ANCDT07"/>
    </extension>
    <extension url="name">
      <valueString value="Should Ultrasound scan is optional"/>
    </extension>
    <extension url="statement">
      <valueString value="/*&#xA;(&quot;Ultrasound scan conducted&quot; = FALSE)&#xA;  AND (&quot;Ultrasound available at the health-care facility&quot; = TRUE)&#xA;  AND (&quot;Gestational age&quot; ≥ 24 weeks)&#xA;*/&#xA;define &quot;Should Ultrasound scan is optional&quot;:&#xA;  ContactData.&quot;Ultrasound done&quot; is false&#xA;    and Config.&quot;Ultrasound available at the health-care facility&quot; = true&#xA;    and ContactData.&quot;Gestational age&quot; &gt;= 24 'weeks'"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="3"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="ANCDT07"/>
    </extension>
    <extension url="name">
      <valueString value="Should Ultrasound scan is optional 2"/>
    </extension>
    <extension url="statement">
      <valueString value="/*&#xA;(&quot;Ultrasound scan conducted&quot; = FALSE)&#xA;  AND (&quot;Ultrasound available at the health-care facility&quot; = FALSE)&#xA;  AND (&quot;Gestational age&quot; ≥ 24 weeks)&#xA;*/&#xA;define &quot;Should Ultrasound scan is optional 2&quot;:&#xA;  ContactData.&quot;Ultrasound done&quot; is false&#xA;    and not Config.&quot;Ultrasound available at the health-care facility&quot; = false&#xA;    and ContactData.&quot;Gestational age&quot; &gt;= 24 'weeks'"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="4"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="ANCDT07"/>
    </extension>
    <extension url="name">
      <valueString value="Should Conduct ultrasound at the health-care facility or the referral facility"/>
    </extension>
    <extension url="statement">
      <valueString value="/*&#xA;&quot;Gestational age&quot; &lt; 24 weeks&#xA;*/&#xA;define &quot;Should Conduct ultrasound at the health-care facility or the referral facility&quot;:&#xA;  ContactData.&quot;Gestational age&quot; &lt; 24 'weeks'"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="5"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="ANCDT07"/>
    </extension>
    <extension url="name">
      <valueString value="Should Conduct ultrasound at the health-care facility or the referral facility optional if deemed necessary by the health worker"/>
    </extension>
    <extension url="statement">
      <valueString value="/*&#xA;&quot;Gestational age&quot; ≥ 24 weeks&#xA;*/&#xA;define &quot;Should Conduct ultrasound at the health-care facility or the referral facility optional if deemed necessary by the health worker&quot;:&#xA;  ContactData.&quot;Gestational age&quot; &gt;= 24 'weeks'"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="6"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="ANCDT07"/>
    </extension>
    <extension url="name">
      <valueString value="Should Conduct ultrasound scan"/>
    </extension>
    <extension url="statement">
      <valueString value="/*&#xA;(&quot;Ultrasound scan conducted&quot; = FALSE)&#xA;  AND (&quot;Ultrasound available at the health-care facility&quot; = TRUE)&#xA;  AND (&quot;Gestational age&quot; &lt; 24 weeks)&#xA;*/&#xA;define &quot;Should Conduct ultrasound scan&quot;:&#xA;  ContactData.&quot;Ultrasound done&quot; is false&#xA;    and Config.&quot;Ultrasound available at the health-care facility&quot; = true&#xA;    and ContactData.&quot;Gestational age&quot; &lt; 24 'weeks'"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="7"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="ANCDT07"/>
    </extension>
    <extension url="name">
      <valueString value="Should Refer to a facility with ultrasound equipment"/>
    </extension>
    <extension url="statement">
      <valueString value="/*&#xA;(&quot;Ultrasound scan conducted&quot; = FALSE)&#xA;  AND (&quot;Ultrasound available at the health-care facility&quot; = FALSE)&#xA;  AND (&quot;Gestational age&quot; &lt; 24 weeks)&#xA;*/&#xA;define &quot;Should Refer to a facility with ultrasound equipment&quot;:&#xA;  ContactData.&quot;Ultrasound done&quot; is false&#xA;    and not Config.&quot;Ultrasound available at the health-care facility&quot; = false&#xA;    and ContactData.&quot;Gestational age&quot; &lt; 24 'weeks'"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="8"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="FHIRHelpers"/>
    </extension>
    <extension url="name">
      <valueString value="ToBoolean"/>
    </extension>
    <extension url="statement">
      <valueString value="define function ToBoolean(value boolean): value.value"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="9"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="WHOCommon"/>
    </extension>
    <extension url="name">
      <valueString value="MostRecent"/>
    </extension>
    <extension url="statement">
      <valueString value="define function MostRecent(observations List&lt;Observation&gt;):&#xA;  Last(&#xA;    observations O&#xA;      sort by issued&#xA;  )"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="10"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="FHIRHelpers"/>
    </extension>
    <extension url="name">
      <valueString value="ToString"/>
    </extension>
    <extension url="statement">
      <valueString value="define function ToString(value ObservationStatus): value.value"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="11"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="WHOCommon"/>
    </extension>
    <extension url="name">
      <valueString value="ModifierExtension"/>
    </extension>
    <extension url="statement">
      <valueString value="/*&#xA;@description: Returns the single WHO core modifier extension (if present) on the given resource with the specified id.&#xA;@comment: This function uses singleton from to ensure that a run-time exception is thrown if there&#xA;is more than one extension on the given resource with the specified url.&#xA;*/&#xA;define function ModifierExtension(domainResource DomainResource, id String):&#xA;  singleton from ModifierExtensions(domainResource, id)"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="12"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="WHOCommon"/>
    </extension>
    <extension url="name">
      <valueString value="ModifierExtensions"/>
    </extension>
    <extension url="statement">
      <valueString value="/*&#xA;@description: Returns any WHO core modifier extensions defined on the given resource with the specified id.&#xA;@comment: NOTE: Extensions are not the preferred approach, but are used as a way to access&#xA;content that is defined by extensions but not yet surfaced in the&#xA;CQL model info.&#xA;*/&#xA;define function ModifierExtensions(domainResource DomainResource, id String):&#xA;  domainResource.modifierExtension E&#xA;&#x9;  where E.url = ('http://fhir.org/guides/who/core/StructureDefinition/' + id)&#xA;&#x9;&#x9;return E"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="13"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="FHIRHelpers"/>
    </extension>
    <extension url="name">
      <valueString value="ToString"/>
    </extension>
    <extension url="statement">
      <valueString value="define function ToString(value uri): value.value"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="14"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="FHIRHelpers"/>
    </extension>
    <extension url="name">
      <valueString value="ToString"/>
    </extension>
    <extension url="statement">
      <valueString value="define function ToString(value string): value.value"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="15"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="FHIRHelpers"/>
    </extension>
    <extension url="name">
      <valueString value="ToQuantity"/>
    </extension>
    <extension url="statement">
      <valueString value="define function ToQuantity(quantity FHIR.Quantity):&#xA;    case&#xA;        when quantity is null then null&#xA;        when quantity.value is null then null&#xA;        when quantity.comparator is not null then&#xA;            Message(null, true, 'FHIRHelpers.ToQuantity.ComparatorQuantityNotSupported', 'Error', 'FHIR Quantity value has a comparator and cannot be converted to a System.Quantity value.')&#xA;        when quantity.system is null or quantity.system.value = 'http://unitsofmeasure.org'&#xA;              or quantity.system.value = 'http://hl7.org/fhirpath/CodeSystem/calendar-units' then&#xA;            System.Quantity { value: quantity.value.value, unit: ToCalendarUnit(Coalesce(quantity.code.value, quantity.unit.value, '1')) }&#xA;        else&#xA;            Message(null, true, 'FHIRHelpers.ToQuantity.InvalidFHIRQuantity', 'Error', 'Invalid FHIR Quantity code: ' &amp; quantity.unit.value &amp; ' (' &amp; quantity.system.value &amp; '|' &amp; quantity.code.value &amp; ')')&#xA;    end"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="16"/>
    </extension>
  </extension>
  <extension url="http://hl7.org/fhir/StructureDefinition/cqf-logicDefinition">
    <extension url="libraryName">
      <valueString value="FHIRHelpers"/>
    </extension>
    <extension url="name">
      <valueString value="ToCalendarUnit"/>
    </extension>
    <extension url="statement">
      <valueString value="define function ToCalendarUnit(unit System.String):&#xA;    case unit&#xA;        when 'ms' then 'millisecond'&#xA;        when 's' then 'second'&#xA;        when 'min' then 'minute'&#xA;        when 'h' then 'hour'&#xA;        when 'd' then 'day'&#xA;        when 'wk' then 'week'&#xA;        when 'mo' then 'month'&#xA;        when 'a' then 'year'&#xA;        else unit&#xA;    end"/>
    </extension>
    <extension url="displaySequence">
      <valueInteger value="17"/>
    </extension>
  </extension>
  <extension id="effective-data-requirements" url="http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-effectiveDataRequirements">
    <valueCanonical value="#effective-data-requirements"/>
  </extension>
  <extension url="http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-softwaresystem">
    <valueReference>
      <reference value="Device/cqf-tooling"/>
    </valueReference>
  </extension>
  <url value="http://smart.who.int/anc/PlanDefinition/ANCDT07"/>
  <identifier>
    <use value="official"/>
    <value value="ANC.DT.07"/>
  </identifier>
  <version value="0.3.0"/>
  <name value="ANCDT07"/>
  <title value="ANC.DT.07 Ultrasound recommendation"/>
  <type>
    <coding>
      <system value="http://terminology.hl7.org/CodeSystem/plan-definition-type"/>
      <code value="eca-rule"/>
    </coding>
  </type>
  <status value="active"/>
  <experimental value="false"/>
  <date value="2025-06-24T13:58:48-06:00"/>
  <publisher value="World Health Organization (WHO)"/>
  <contact>
    <telecom>
      <system value="url"/>
      <value value="https://www.who.int"/>
    </telecom>
  </contact>
  <description value="An ultrasound is recommended for all pregnant women before 24 weeks of gestation (early ultrasound). If there's no ultrasound available at that health-carte facility, the woman should be referred to another facility in which she can receive an ultrasound."/>
  <useContext>
    <code>
      <system value="http://terminology.hl7.org/CodeSystem/usage-context-type"/>
      <code value="task"/>
      <display value="Workflow Task"/>
    </code>
    <valueCodeableConcept>
      <coding>
        <system value="http://smart.who.int/anc/CodeSystem/activity-codes"/>
        <code value="During"/>
        <display value="woman’s history/profile or lab and imaging tests"/>
      </coding>
    </valueCodeableConcept>
  </useContext>
  <jurisdiction>
    <coding>
      <system value="http://unstats.un.org/unsd/methods/m49/m49.htm"/>
      <code value="001"/>
    </coding>
  </jurisdiction>
  <library value="http://smart.who.int/anc/Library/ANCDT07"/>
  <action>
    <title value="ANC.DT.07 Ultrasound recommendation"/>
    <trigger>
      <type value="named-event"/>
      <name value="During woman’s history/profile or lab and imaging tests"/>
    </trigger>
    <action id="1">
      <title value="Conduct ultrasound at the health-care facility or the referral facility"/>
      <description value="Conduct ultrasound at the health-care facility or the referral facility"/>
      <textEquivalent value="An ultrasound is recommended for all women before 24 weeks gestation"/>
      <documentation>
        <type value="citation"/>
        <label value="WHO ANC recommendations (2016): B.2.4. Ultrasound scan (3)"/>
      </documentation>
      <condition>
        <kind value="applicability"/>
        <expression>
          <description value="&quot;Gestational age&quot; &lt; 24 weeks"/>
          <language value="text/cql-identifier"/>
          <expression value="Should Conduct ultrasound at the health-care facility or the referral facility"/>
        </expression>
      </condition>
    </action>
    <action id="2">
      <title value="Conduct ultrasound at the health-care facility or the referral facility optional if deemed necessary by the health worker"/>
      <description value="Conduct ultrasound at the health-care facility or the referral facility optional if deemed necessary by the health worker"/>
      <textEquivalent value="An ultrasound is recommended for all women even after 24 weeks gestation if deemed necessary (e.g. to identify the number of fetuses, fetal presentation or placenta location)"/>
      <documentation>
        <type value="citation"/>
        <label value="WHO ANC recommendations (2016): B.2.4. Ultrasound scan (3)"/>
      </documentation>
      <condition>
        <kind value="applicability"/>
        <expression>
          <description value="&quot;Gestational age&quot; ≥ 24 weeks"/>
          <language value="text/cql-identifier"/>
          <expression value="Should Conduct ultrasound at the health-care facility or the referral facility optional if deemed necessary by the health worker"/>
        </expression>
      </condition>
    </action>
    <action id="3">
      <title value="Conduct ultrasound scan"/>
      <description value="Conduct ultrasound scan"/>
      <textEquivalent value="An ultrasound is recommended for all women before 24 weeks gestation or even after if deemed necessary (e.g. to identify the number of fetuses, fetal presentation or placenta location). &#xA;An early ultrasound is key to estimate gestational age, improve detection of fetal anomalies and multiple fetuses, reduce induction of labour for post-term pregnancy, and improve a woman’s pregnancy experience."/>
      <documentation>
        <type value="citation"/>
        <label value="WHO ANC recommendations (2016): B.2.4. Ultrasound scan (3)"/>
      </documentation>
      <condition>
        <kind value="applicability"/>
        <expression>
          <description value="(&quot;Ultrasound scan conducted&quot; = FALSE)&#xA;  AND (&quot;Ultrasound available at the health-care facility&quot; = TRUE)&#xA;  AND (&quot;Gestational age&quot; &lt; 24 weeks)"/>
          <language value="text/cql-identifier"/>
          <expression value="Should Conduct ultrasound scan"/>
        </expression>
      </condition>
    </action>
    <action id="4">
      <title value="Refer to a facility with ultrasound equipment"/>
      <description value="Refer to a facility with ultrasound equipment"/>
      <textEquivalent value="If an ultrasound cannot be conducted at the health-care facility, the woman should be referred to another health-care facility in which she can receive an ultrasound. &#xA;An ultrasound is recommended for all women before 24 weeks gestation or even after if deemed necessary (e.g. to identify the number of fetuses, fetal presentation or placenta location). &#xA;An early U/S is key to estimate gestational age, improve detection of fetal anomalies and multiple fetuses, reduce induction of labour for post-term pregnancy, and improve a woman’s pregnancy experience."/>
      <documentation>
        <type value="citation"/>
        <label value="WHO ANC recommendations (2016): B.2.4. Ultrasound scan (3)"/>
      </documentation>
      <condition>
        <kind value="applicability"/>
        <expression>
          <description value="(&quot;Ultrasound scan conducted&quot; = FALSE)&#xA;  AND (&quot;Ultrasound available at the health-care facility&quot; = FALSE)&#xA;  AND (&quot;Gestational age&quot; &lt; 24 weeks)"/>
          <language value="text/cql-identifier"/>
          <expression value="Should Refer to a facility with ultrasound equipment"/>
        </expression>
      </condition>
    </action>
    <action id="5">
      <title value="Ultrasound scan is optional"/>
      <description value="Ultrasound scan is optional"/>
      <textEquivalent value="An ultrasound is recommended for all women before 24 weeks gestation or even after if deemed necessary (e.g. to identify the number of fetuses, fetal presentation or placenta location)"/>
      <documentation>
        <type value="citation"/>
        <label value="WHO ANC recommendations (2016): B.2.4. Ultrasound scan (3)"/>
      </documentation>
      <condition>
        <kind value="applicability"/>
        <expression>
          <description value="(&quot;Ultrasound scan conducted&quot; = FALSE)&#xA;  AND (&quot;Ultrasound available at the health-care facility&quot; = TRUE)&#xA;  AND (&quot;Gestational age&quot; ≥ 24 weeks)"/>
          <language value="text/cql-identifier"/>
          <expression value="Should Ultrasound scan is optional"/>
        </expression>
      </condition>
      <action>
        <title value="Ultrasound scan is optional"/>
      </action>
      <action>
        <title value="Conduct ultrasound if deemed necessary by the health worker"/>
      </action>
    </action>
    <action id="6">
      <title value="Ultrasound scan is optional"/>
      <description value="Ultrasound scan is optional 2"/>
      <textEquivalent value="An ultrasound is recommended for all women before 24 weeks gestation or even after if deemed necessary (e.g. to identify the number of fetuses, fetal presentation or placenta location)"/>
      <documentation>
        <type value="citation"/>
        <label value="WHO ANC recommendations: B.2.4. Ultrasound scan (3)"/>
      </documentation>
      <condition>
        <kind value="applicability"/>
        <expression>
          <description value="(&quot;Ultrasound scan conducted&quot; = FALSE)&#xA;  AND (&quot;Ultrasound available at the health-care facility&quot; = FALSE)&#xA;  AND (&quot;Gestational age&quot; ≥ 24 weeks)"/>
          <language value="text/cql-identifier"/>
          <expression value="Should Ultrasound scan is optional 2"/>
        </expression>
      </condition>
      <action>
        <title value="Ultrasound scan is optional"/>
      </action>
      <action>
        <title value="Refer for ultrasound if deemed necessary by the health worker"/>
      </action>
    </action>
  </action>
</PlanDefinition>